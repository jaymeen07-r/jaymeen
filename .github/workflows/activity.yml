name: Test Activity Update (10 sec)

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Update README every 10 seconds (test)
        run: |
          FILE=README.md

          for i in {1..5}
          do
            STREAK=$(grep -oP '(?<=<!-- STREAK -->)\d+(?=<!-- STREAK -->)' $FILE)
            NEW_STREAK=$((STREAK + 1))
            sed -i "s/<!-- STREAK -->$STREAK<!-- STREAK -->/<!-- STREAK -->$NEW_STREAK<!-- STREAK -->/" $FILE

            HOURS=$(shuf -i6-9 -n1)
            sed -i "s/<!-- HOURS -->.*<!-- HOURS -->/<!-- HOURS -->$HOURS<!-- HOURS -->/" $FILE

            CONTRIB=$(shuf -i5-20 -n1)
            sed -i "s/<!-- CONTRIB -->.*<!-- CONTRIB -->/<!-- CONTRIB -->$CONTRIB<!-- CONTRIB -->/" $FILE

            git config user.name "github-actions"
            git config user.email "actions@github.com"
            git add README.md
            git commit -m "ðŸ§ª Test update $i"
            git push

            sleep 10
          done
