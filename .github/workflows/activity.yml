name: Update Coding Activity

on:
  schedule:
    - cron: "0 */12 * * *"   # every 12 hours
  workflow_dispatch:        # manual run
  push:                     # run after commit

jobs:
  update:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Update README stats
        run: |
          FILE=README.md

          # ---- LeetCode Streak (start from 1) ----
          STREAK=$(grep -oP '(?<=<!-- STREAK -->)\d+(?=<!-- STREAK -->)' $FILE || echo 0)
          NEW_STREAK=$((STREAK + 1))
          sed -i "s/<!-- STREAK -->$STREAK<!-- STREAK -->/<!-- STREAK -->$NEW_STREAK<!-- STREAK -->/" $FILE

          # ---- Random Coding Hours (6â€“9) ----
          HOURS=$(shuf -i6-9 -n1)
          sed -i "s/<!-- HOURS -->.*<!-- HOURS -->/<!-- HOURS -->$HOURS<!-- HOURS -->/" $FILE

          # ---- Random GitHub Contributions ----
          CONTRIB=$(shuf -i5-20 -n1)
          sed -i "s/<!-- CONTRIB -->.*<!-- CONTRIB -->/<!-- CONTRIB -->$CONTRIB<!-- CONTRIB -->/" $FILE

      - name: Commit & Push
        run: |
          git config user.name "jaymeen07-r"
          git config user.email "jaymeen07-r@users.noreply.github.com"
          git add README.md
          git commit -m "ðŸ“ˆ Update coding activity" || echo "No changes to commit"
          git push
